{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/solorzao/openclaw-minecraft-plugin/schemas/events.schema.json",
  "title": "OpenClaw Minecraft Bot Events",
  "description": "Schema for events.json - game events written by bot, read by AI agent. Rolling buffer of max 200 events.",
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "id": {
        "type": "integer",
        "description": "Auto-incrementing event ID"
      },
      "timestamp": {
        "type": "number",
        "description": "Unix timestamp in milliseconds"
      },
      "type": {
        "type": "string",
        "enum": [
          "spawn",
          "chat",
          "whisper",
          "danger",
          "hurt",
          "death",
          "woke_up",
          "goal_reached",
          "path_failed",
          "error",
          "disconnect",
          "kicked",
          "command_result"
        ],
        "description": "Event type"
      }
    },
    "required": ["id", "timestamp", "type"],
    "allOf": [
      {
        "if": { "properties": { "type": { "const": "spawn" } } },
        "then": {
          "properties": {
            "position": {
              "type": "object",
              "properties": {
                "x": { "type": "integer" },
                "y": { "type": "integer" },
                "z": { "type": "integer" }
              },
              "required": ["x", "y", "z"]
            }
          }
        }
      },
      {
        "if": { "properties": { "type": { "const": "chat" } } },
        "then": {
          "properties": {
            "username": { "type": "string", "description": "Player who sent the message" },
            "message": { "type": "string", "description": "Chat message content" }
          },
          "required": ["type", "username", "message"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "whisper" } } },
        "then": {
          "properties": {
            "username": { "type": "string" },
            "message": { "type": "string" }
          },
          "required": ["type", "username", "message"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "danger" } } },
        "then": {
          "properties": {
            "reason": { "type": "string", "enum": ["low_health"] },
            "health": { "type": "number" },
            "food": { "type": "number" }
          },
          "required": ["type", "reason", "health", "food"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "hurt" } } },
        "then": {
          "properties": {
            "health": { "type": "number", "description": "Current health after damage" }
          },
          "required": ["type", "health"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "path_failed" } } },
        "then": {
          "properties": {
            "status": { "type": "string", "enum": ["noPath", "timeout", "stuck"] }
          },
          "required": ["type", "status"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "error" } } },
        "then": {
          "properties": {
            "message": { "type": "string" }
          },
          "required": ["type", "message"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "kicked" } } },
        "then": {
          "properties": {
            "reason": { "type": "string" }
          },
          "required": ["type", "reason"]
        }
      },
      {
        "if": { "properties": { "type": { "const": "command_result" } } },
        "then": {
          "properties": {
            "commandId": { "type": "string", "description": "ID of the command that produced this result" },
            "success": { "type": "boolean", "description": "Whether the command succeeded" },
            "detail": { "type": "string", "description": "Human-readable result description" }
          },
          "required": ["type", "commandId", "success", "detail"]
        }
      }
    ]
  }
}
